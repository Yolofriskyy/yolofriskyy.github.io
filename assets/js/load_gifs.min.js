document.addEventListener("DOMContentLoaded", function() {
  const gifs = document.querySelectorAll('.gif-wrapper img');
  let loadedGifs = 0;

  // Function to hide loading indicators and play all GIFs once loaded
  function playGifs() {
      gifs.forEach(gif => {
          const wrapper = gif.closest('.gif-wrapper');
          const loadingIndicator = wrapper.querySelector('.loading-indicator');

          gif.style.opacity = 1;
          const src = gif.getAttribute('src');
          gif.setAttribute('src', '');  
          gif.setAttribute('src', src); 

          // Hide the loading indicator
          if (loadingIndicator) {
              loadingIndicator.style.display = 'none';
          }
      });
  }

  // Check when each GIF is loaded
  gifs.forEach(gif => {
      const wrapper = gif.closest('.gif-wrapper');
      const loadingIndicator = wrapper.querySelector('.loading-indicator');
      
      gif.style.opacity = 0.5; // Set initial opacity to 0.5

      // Show the loading indicator
      if (loadingIndicator) {
          loadingIndicator.style.display = 'block';
      }

      // If the image is already loaded (cached), hide the indicator immediately
      if (gif.complete) {
          loadedGifs++;
          gif.style.opacity = 1;
          if (loadingIndicator) {
              loadingIndicator.style.display = 'none';
          }
      } else {
          gif.addEventListener('load', () => {
              loadedGifs++;
              gif.style.opacity = 1; // Make the GIF fully visible
              if (loadingIndicator) {
                  loadingIndicator.style.display = 'none';
              }
              
              if (loadedGifs === gifs.length) {
                  playGifs();
              }
          });
      }
  });

  // Call playGifs if all GIFs were already loaded
  if (loadedGifs === gifs.length) {
      playGifs();
  }
});